---
import GitHub from "./icons/github.astro";
import LinkedIn from "./icons/linkeding.astro";
import Instagram from "./icons/instragram.astro";

// Componente Contact - Estética Premium con Formulario en Card
---

<section
    id="contact"
    class="relative py-16 lg:py-24 px-6 bg-[#1a1a1a] overflow-hidden"
>
    <!-- Decoración de fondo -->
    <div
        class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-[#FFD700] opacity-[0.02] blur-[150px] rounded-full pointer-events-none"
    >
    </div>

    <div class="max-w-6xl mx-auto relative z-10">
        <div
            class="grid grid-cols-1 lg:grid-cols-2 gap-16 lg:gap-24 items-start"
        >
            <!-- Columna Izquierda: Formulario -->
            <div class="order-2 lg:order-1 reveal reveal-left">
                <form id="contact-form">
                    <div class="space-y-4">
                        <label
                            for="email"
                            class="block text-sm font-medium text-white/80 ml-1"
                            >Tu Email</label
                        >
                        <input
                            type="email"
                            id="email"
                            name="email"
                            placeholder="correo@ejemplo.com"
                            class="w-full px-6 py-4 bg-white/5 border border-white/10 rounded-xl text-white placeholder:text-white/40 focus:outline-none focus:border-[#FFD700]/50 transition-colors"
                        />
                        <p
                            id="error-email"
                            class="text-xs text-red-400 mt-1 h-3"
                        >
                        </p>
                    </div>

                    <div class="space-y-4">
                        <label
                            for="subject"
                            class="block text-sm font-medium text-white/80 ml-1"
                            >Asunto</label
                        >
                        <input
                            type="text"
                            id="subject"
                            name="subject"
                            placeholder="¿En qué puedo ayudarte?"
                            class="w-full px-6 py-4 bg-white/5 border border-white/10 rounded-xl text-white placeholder:text-white/40 focus:outline-none focus:border-[#FFD700]/50 transition-colors"
                        />
                        <p
                            id="error-subject"
                            class="text-xs text-red-400 mt-1 h-3"
                        >
                        </p>
                    </div>

                    <div class="space-y-4">
                        <label
                            for="message"
                            class="block text-sm font-medium text-white/80 ml-1"
                            >Tu Mensaje</label
                        >
                        <textarea
                            id="message"
                            name="message"
                            rows="5"
                            placeholder="Cuéntame sobre tu proyecto..."
                            class="w-full px-6 py-4 bg-white/5 border border-white/10 rounded-xl text-white placeholder:text-white/40 focus:outline-none focus:border-[#FFD700]/50 transition-colors resize-none"
                        ></textarea>
                        <p
                            id="error-message"
                            class="text-xs text-red-400 mt-1 h-3"
                        >
                        </p>
                    </div>

                    <button
                        type="submit"
                        class="flex items-center justify-center gap-2 w-full lg:w-auto px-10 py-3 bg-[#FFD700] text-black text-xs font-bold uppercase tracking-widest rounded-lg hover:bg-white transition-all duration-300"
                    >
                        <span>Enviar Mensaje</span>
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="w-4 h-4"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        >
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"
                            ></polygon>
                        </svg>
                    </button>
                    <div
                        id="form-status"
                        class="text-center lg:text-left text-sm font-medium mt-4 h-6"
                    >
                    </div>
                </form>
            </div>

            <!-- Columna Derecha: Información de Contacto -->
            <div class="order-1 lg:order-2 space-y-12 reveal reveal-right">
                <div>
                    <span
                        class="text-[#FFD700] font-medium tracking-[0.3em] uppercase text-xs"
                        >Contacto</span
                    >
                    <h2
                        class="text-5xl lg:text-7xl font-bold text-white mt-4 font-serif leading-tight"
                    >
                        Hablemos<span class="text-[#FFD700]">.</span>
                    </h2>
                    <p
                        class="text-white/70 mt-6 text-lg font-light leading-relaxed max-w-md"
                    >
                        Transformando ideas en experiencias digitales de <span
                            class="text-white font-normal">clase mundial</span
                        >. Estoy listo para el siguiente desafío.
                    </p>
                </div>

                <!-- Info Grid -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-10">
                    <div class="flex gap-5 group">
                        <div
                            class="w-12 h-12 shrink-0 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-[#FFD700] group-hover:bg-[#FFD700] group-hover:text-black transition-all duration-300"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="w-5 h-5"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                ><path
                                    d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"
                                ></path></svg
                            >
                        </div>
                        <div>
                            <h4
                                class="text-white font-bold text-sm uppercase tracking-wider mb-1"
                            >
                                Llamar
                            </h4>
                            <p class="text-white/60 text-sm font-light">
                                +591 76620678
                            </p>
                        </div>
                    </div>
                    <div class="flex gap-5 group">
                        <div
                            class="w-12 h-12 shrink-0 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-[#FFD700] group-hover:bg-[#FFD700] group-hover:text-black transition-all duration-300"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="w-5 h-5"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                ><path
                                    d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"
                                ></path><polyline points="22,6 12,13 2,6"
                                ></polyline></svg
                            >
                        </div>
                        <div>
                            <h4
                                class="text-white font-bold text-sm uppercase tracking-wider mb-1"
                            >
                                Email
                            </h4>
                            <p class="text-white/60 text-sm font-light">
                                josuekennedy@gmail.com
                            </p>
                        </div>
                    </div>

                    <div class="flex gap-5 group">
                        <div
                            class="w-12 h-12 shrink-0 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-[#FFD700] group-hover:bg-[#FFD700] group-hover:text-black transition-all duration-300"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="w-5 h-5"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                ><circle cx="12" cy="12" r="10"></circle><line
                                    x1="2"
                                    y1="12"
                                    x2="22"
                                    y2="12"></line><path
                                    d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"
                                ></path></svg
                            >
                        </div>
                        <div>
                            <h4
                                class="text-white font-bold text-sm uppercase tracking-wider mb-1"
                            >
                                Sitio Web
                            </h4>
                            <p class="text-white/60 text-sm font-light">
                                josuekennedy.com
                            </p>
                        </div>
                    </div>

                    <div class="flex gap-5 group">
                        <div
                            class="w-12 h-12 shrink-0 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-[#FFD700] group-hover:bg-[#FFD700] group-hover:text-black transition-all duration-300"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="w-5 h-5"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                ><path
                                    d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"
                                ></path><circle cx="12" cy="10" r="3"
                                ></circle></svg
                            >
                        </div>
                        <div>
                            <h4
                                class="text-white font-bold text-sm uppercase tracking-wider mb-1"
                            >
                                Ubicación
                            </h4>
                            <p class="text-white/60 text-sm font-light">
                                Santa Cruz de la Sierra, Bolivia
                            </p>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</section>

<script>
    import { actions } from "astro:actions";
    import { z } from "zod";

    const contactSchema = z.object({
        email: z.string().email("Ingresa un correo electrónico válido"),
        subject: z
            .string()
            .min(5, "El asunto debe tener al menos 5 caracteres"),
        message: z
            .string()
            .min(10, "El mensaje debe tener al menos 10 caracteres"),
    });

    const form = document.getElementById("contact-form") as HTMLFormElement;
    const status = document.getElementById("form-status") as HTMLDivElement;

    if (form) {
        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            // Limpiar errores previos
            const errorFields = ["email", "subject", "message"];
            errorFields.forEach((field) => {
                const errorEl = document.getElementById(`error-${field}`);
                if (errorEl) errorEl.textContent = "";
                const inputEl = document.getElementById(field);
                if (inputEl) inputEl.classList.remove("border-red-500/50");
            });
            status.textContent = "";

            const formData = new FormData(form);
            const data = {
                email: formData.get("email") as string,
                subject: formData.get("subject") as string,
                message: formData.get("message") as string,
            };

            const result = contactSchema.safeParse(data);

            if (!result.success) {
                result.error.issues.forEach((issue) => {
                    const fieldName = issue.path[0];
                    const errorEl = document.getElementById(
                        `error-${fieldName}`,
                    );
                    if (errorEl) {
                        errorEl.textContent = issue.message;
                        errorEl.classList.add("animate-pulse");
                    }
                    const inputEl = document.getElementById(
                        fieldName as string,
                    );
                    if (inputEl) inputEl.classList.add("border-red-500/50");
                });
                return;
            }

            // Envío con Astro Actions
            const submitBtn = form.querySelector(
                'button[type="submit"]',
            ) as HTMLButtonElement;

            submitBtn.disabled = true;
            submitBtn.style.opacity = "0.7";
            status.textContent = "Enviando...";
            status.classList.remove("text-green-500", "text-red-500");
            status.classList.add("text-[#FFD700]");

            const { data: responseData, error } = await actions.send(data);

            if (!error) {
                status.textContent = "¡Mensaje enviado con éxito!";
                status.classList.replace("text-[#FFD700]", "text-green-500");
                form.reset();

                setTimeout(() => {
                    status.textContent = "";
                }, 5000);
            } else {
                console.error(error);
                status.textContent =
                    error.message || "Error al enviar el correo.";
                status.classList.replace("text-[#FFD700]", "text-red-500");
            }

            submitBtn.disabled = false;
            submitBtn.style.opacity = "1";
        });
    }
</script>
